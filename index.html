<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>SpotMyBackup</title>
</head>
<body>
  <button id="login">Login with Spotify</button>

  <script>
    let config;

    fetch('config.json')
      .then(res => res.json())
      .then(conf => {
        config = conf;

        document.getElementById('login').addEventListener('click', () => {
          const width = 600, height = 700;
          const left = (screen.width / 2) - (width / 2);
          const top = (screen.height / 2) - (height / 2);

          const authURL = "https://accounts.spotify.com/authorize?" + new URLSearchParams({
            client_id: config.client_id,
            response_type: "token",
            redirect_uri: config.redirect_uri,
            scope: "playlist-read playlist-read-private playlist-modify-public playlist-modify-private user-library-read user-library-modify",
            show_dialog: "true"
          });

          window.open(authURL, "Spotify Login", `width=${width},height=${height},top=${top},left=${left}`);
        });

        window.addEventListener('message', (e) => {
          if (e.origin === new URL(config.uri).origin && e.data.token) {
            const token = e.data.token;
            console.log("Logged in! Token:", token);
            // আপনি এখানে playlist fetch শুরু করতে পারেন
          }
        });
      })
      .catch(err => {
        console.error("Failed to load config:", err);
      });
  </script>
</body>
</html>